<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Trap API: IIC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Trap API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__trapset__iic.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">IIC<div class="ingroups"><a class="el" href="group__api.html">Customer Trap API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga029c837fda007e0e97e0f28b8863cbd8"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__iic.html#ga029c837fda007e0e97e0f28b8863cbd8">I2cTransfer</a> (uint16 address, const uint8 *tx, uint16 tx_len, uint8 *rx, uint16 rx_len)</td></tr>
<tr class="memdesc:ga029c837fda007e0e97e0f28b8863cbd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to the i2c bus.  <a href="#ga029c837fda007e0e97e0f28b8863cbd8">More...</a><br /></td></tr>
<tr class="separator:ga029c837fda007e0e97e0f28b8863cbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga029c837fda007e0e97e0f28b8863cbd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga029c837fda007e0e97e0f28b8863cbd8">&#9670;&nbsp;</a></span>I2cTransfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16 I2cTransfer </td>
          <td>(</td>
          <td class="paramtype">uint16&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8 *&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16&#160;</td>
          <td class="paramname"><em>tx_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8 *&#160;</td>
          <td class="paramname"><em>rx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16&#160;</td>
          <td class="paramname"><em>rx_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Access to the i2c bus. </p>
<p>fileBlueCore can support one master i2c interface. </p><dl class="section note"><dt>Note</dt><dd>I2C PIOs in BlueCore are configured with PSKEY_I2C_SDA_PIO &amp; PSKEY_I2C_SCL_PIO if PS storage is not I2C EEPROM. The default value of I2C PIOs are defined in device datasheet. The BlueCore acts as the sole bus master. The speed of the bus (standard mode, i.e. up to 100kHz or fast mode, i.e. up to 400kHz) is configured with PSKEY_I2C_CONFIG. </dd></dl>
<dl class="section user"><dt></dt><dd>Only 7bit slave addresses are explicitly supported. However, 10bit addresses can be used by splitting the 10bit address between the slave address (11110xx) and first data byte as defined by the I2C specification. </dd></dl>
<dl class="section user"><dt></dt><dd>Use of the I2C bus requires pull-up resistors connected to the respective PIOs. Details of how to choose such resistors can be found in the I2C-Bus Specification, and recommended values for a typical design are listed in the BlueCore databooks. Allows transfer of data across the i2c interface. Perform a composite transfer consisting of a sequence of writes followed by a sequence of reads. These will be separated by a repeated start condition (Sr) and slave address if both reads and writes are performed. The general sequence of operations performed is:<ul>
<li>Start condition (S).</li>
<li>Write slave address and direction byte (address | 0).</li>
<li>Write <em>tx_len</em> data bytes from the buffer at <em>tx</em>.</li>
<li>Repeated start condition (Sr) if <em>tx_len</em> and <em>rx_len</em> are non-zero.</li>
<li>Write slave address and direction byte (address | 1) if <em>tx_len</em> and <em>rx_len</em> are non-zero.</li>
<li>Read <em>rx_len</em> data bytes into the buffer at <em>rx</em>, acknowledging all but the final byte.</li>
<li>Stop condition (P). If <em>tx_len</em> is non-zero and <em>rx_len</em> is zero then the sequence reduces to:</li>
<li>Start condition (S).</li>
<li>Write slave address and direction byte (address | 0).</li>
<li>Write <em>tx_len</em> data bytes from the buffer at <em>tx</em>.</li>
<li>Stop condition (P). Alternatively, if <em>tx_len</em> is zero and <em>rx_len</em> is non-zero then the sequence reduces to:</li>
<li>Start condition (S).</li>
<li>Write slave address and direction byte (address | 1).</li>
<li>Read <em>rx_len</em> data bytes, acknowledging all but the final byte.</li>
<li>Stop condition (P). Finally, if both <em>tx_len</em> and <em>rx_len</em> are zero then the following minimal sequence is used:</li>
<li>Start condition (S).</li>
<li>Write slave address and direction byte (address | 1).</li>
<li>Stop condition (P). The transfer will be aborted if either the slave address or a byte being written is not acknowledged. The stop condition (P) will still be driven to reset the bus. Note also that the address is not shifted before being combined with the direction bit, i.e. the slave address should occupy bits 7 to 1 of address. This allows the R/W bit to be forced to 1 for composite write/read transfers without a repeated start condition (Sr). If either <em>tx_len</em> or <em>rx_len</em> exceeds 64, failure may be returned or performance may be impaired; for instance, audio streaming may be disrupted. </li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>The device address of the slave for this transfer. </td></tr>
    <tr><td class="paramname">tx</td><td>A pointer to the data we wish to transmit. One octet per word. </td></tr>
    <tr><td class="paramname">tx_len</td><td>The length of the data we wish to transmit. </td></tr>
    <tr><td class="paramname">rx</td><td>A pointer to the memory we wish to read received data into. One octet per word. </td></tr>
    <tr><td class="paramname">rx_len</td><td>The length of the data we wish to receive. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes acknowledged including the address bytes and the final data byte (which isn't strictly acknowledged). </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
